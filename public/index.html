<!DOCTYPE html>
<html>
<head>
  <title>Dystopia</title>

  <!-- Bootstrap for general layout and styling -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

  <!-- Our WebRTC application styling -->
  <link rel="stylesheet" type="text/css" href="style/datachannel-demo.css">
</head>
<body>

  <nav class="navbar" role="navigation">
    <div class="container">

      <span>| Realtime API</span>

      <a href="http://pusher.com/pricing"><button class="btn signup-button">Create a Free Account</button></a>
    </div>
  </nav>
    
  <div class="container">
    <div class="row">
      <header class="col-md-12">
        <h1>Dystopia</h1>
      </header>
    </div>

    <div class="row">
      <section class="col-md-12">
        <p>This chat application uses WebRTC to create a peer-to-peer, server-less connection between you and the recipient of your chat messages, a bit like Skype!</p>
        
        <hr>

        <h2>Getting started</h2>

        <ol>
          <li>Type a channel name and click <strong>create</strong></li>
          <li>Open the chat in another tab</li>
          <li>Type the same channel name and click <strong>join</strong></li>
          <li>Wait a moment and start chatting!</li>
        </ol>

        <!-- WebRTC demo -->
        <div class="demo">
          <div class="demo-connect">
            <input type="text" class="demo-chat-channel-input form-control" placeholder="Channel name"></input>
            <button class="demo-chat-create btn btn-primary">Create</button>
            <button class="demo-chat-join btn btn-warning">Join</button>
          </div>
          <div class="osc-stuff ">
            <div class="osc-input">
              <input type="text" 
              name="osc-msg"
              class="osc-msg-input form-control"
              placeholder="OSC messages about to come">

              <!-- <input type="checkbox"
              class="send-osc"
              name="send-osc"
              data-toggle="toggle"
              data-on="Enabled" data-off="Disabled"> -->
              <button class=" btn" id="send-osc">Send OSC Message</button>
            <button class="send-osc btn btn-dark"
            data-toggle="button"
            aria-pressed="false" autocomplete="off"
            >Send OSC</button>
            <button class=" btn" id="test-osc">test incoming OSC</button>
            </div>
          </div>
          <div class="demo-chat inactive">
            <div class="demo-chat-input">
              <input name="message" class="demo-chat-message-input form-control" placeholder="Message"></input>
              <button class="demo-chat-send btn btn-primary">Send</button>
            </div>
            <ul class="demo-chat-messages list-group">
              <li class="list-group-item" data-remove="true">No chat messages available</li>
            </ul>
          <!-- </div>
          <footer>
            <a href="http://pusher.com">Pusher</a> powered peer-to-peer chat
          </footer>
        </div> -->
        <!-- /End WebRTC demo -->
      </section>
    </div>
  </div>
  
  <!-- Zepto for AJAX -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/zepto/1.1.3/zepto.min.js"></script>

  <!-- Pusher for WebRTC signalling -->
  <script src="//js.pusher.com/4.1/pusher.js"></script>
  
  <!-- DataChannel.js for WebRTC functionality -->
  <script src="//webrtc-experiment.com/DataChannel.js"></script>
  
  <!-- OSC-js -->
  <!-- <script type="text/javascript" src="../node_modules/osc-js/lib/osc.browser.min.js"></script> -->
  <script type="text/javascript" src="https://raw.githubusercontent.com/gilfuser/dystopias2/master/node_modules/osc-js/lib/osc.browser.min.js"></script>

  <script src="https://salathegroup.github.io/nodular.js/nodular.js"></script>

  <script>
    // Start time will be useful at the end of the page
    var startTime = new Date();

    // Specify a path prefix on the server for our required scripts
    // _nodularJS_.pathPrefix = 'js/';

    // We don't want required scripts to be loaded from the browser cache
    // Might be removed in production
    _nodularJS_.forceDownloads = true;

    // We want to log to the console execution events
    // Remove or change to 0 in production
    _nodularJS_.loglevel = 2;

    // We'll use that to show the source of downloaded JavaScript files
    // This can be used for debug purposes
    _nodularJS_.onmodulestatuschange = function(module) {
        if (module.status == _nodularJS_.ModuleStatus.PREPARING) {
            var source = module.sourceCode();
            var pres = document.getElementsByClassName(module.file().replace(/^\.\//g, ''));
            showSourceCode(source, module.file(), pres);
        }
    }
</script>

<script>
  const basic_export = require('./app.js');
  showOutput(basic_export);
</script>


  <!-- Our WebRTC application -->
  <script src="chat-osc.js"></script>

  <!-- Fill channel name -->
   <script>
    function getParameterByName(name) {
      name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
      var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
          results = regex.exec(location.search);
      return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }

    var channel = getParameterByName("channel");

    if (channel) {
      document.querySelector(".demo-chat-channel-input").value = channel;
    }
  </script> 
</body>
</html>